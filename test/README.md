# 🧪 테스트 가이드

이 폴더는 Morning Stock Analyzer의 다양한 기능을 테스트하는 스크립트들을 포함합니다.

## 📁 테스트 파일 구조

```
test/
├── __init__.py                    # 테스트 패키지 초기화
├── test_exa_integration.py        # Exa MCP 통합 기능 테스트
├── test_stock_tools.py            # 기본 주식 도구 기능 테스트
└── README.md                      # 이 파일
```

## 🚀 테스트 실행 방법

### 1. 가상환경 활성화
```bash
# macOS/Linux
source venv/bin/activate

# Windows
venv\Scripts\activate
```

### 2. 개별 테스트 실행

#### Exa MCP 통합 기능 테스트
```bash
python test/test_exa_integration.py
```

**테스트 내용:**
- 회사 정보 조회 (Exa MCP 시뮬레이션)
- 목표가 계산 (회사 정보 기반)
- 전체 리포트 생성 (MCP 우선 + OpenAI 백업)
- MCP 기반 리포트 생성 (시뮬레이션 모드)

#### 기본 기능 테스트
```bash
python test/test_stock_tools.py
```

**테스트 내용:**
- 주식명 조회
- 실시간 주식 가격 조회 (KIS API)
- 주식 뉴스 생성 (OpenAI API)

### 3. 전체 테스트 실행
```bash
python test/test_exa_integration.py && python test/test_stock_tools.py
```

## 📊 테스트 결과 예시

### Exa MCP 통합 기능 테스트 결과
```
🧪 Exa MCP 통합 기능 테스트 시작
==================================================

📊 테스트 주식: 005930
------------------------------
1️⃣ 회사 정보 조회 테스트
   ✅ 회사 정보: {'name': '삼성전자', 'industry': 'Technology', ...}

2️⃣ 목표가 계산 테스트
   ✅ 목표가 분석: {'target_price': 96733, 'opinion': 'Strong Buy', ...}

3️⃣ 전체 리포트 생성 테스트
   ✅ 리포트: 삼성전자(005930) 관련 증권사 리포트: 'Strong Buy, 목표가 96,733원...'
   🤖 MCP 기반 리포트 생성 (시뮬레이션 모드)
```

### 기본 기능 테스트 결과
```
🚀 주식 도구 기본 기능 테스트 시작
==================================================
🧪 주식명 조회 테스트
   005930: 삼성전자
   000660: SK하이닉스
   ...

🧪 주식 가격 조회 테스트
   005930: [18:12:04] 삼성전자(005930) 현재 주가는 : '71,400원' 입니다.
   ...

🧪 주식 뉴스 조회 테스트
   005930: 삼성전자(005930) 관련 최신 뉴스: '- 반도체 수요 증가로 실적 호조' 입니다.
   ...
```

## ⚠️ 주의사항

1. **API 키 설정**: 테스트 실행 전 `.env` 파일에 필요한 API 키가 설정되어 있어야 합니다.
2. **네트워크 연결**: KIS API와 OpenAI API에 접근할 수 있는 네트워크 환경이 필요합니다.
3. **가상환경**: 반드시 가상환경을 활성화한 후 테스트를 실행하세요.

## 🔧 문제 해결

### MCP 서버 연결 실패
- Exa MCP 서버에 인증 토큰이 필요할 수 있습니다.
- 시뮬레이션 모드로 자동 전환되어 테스트는 계속 진행됩니다.

### KIS API 오류
- KIS API 키가 올바르게 설정되어 있는지 확인하세요.
- 토큰 캐시 파일이 만료되었을 수 있습니다.

### OpenAI API 오류
- OpenAI API 키가 올바르게 설정되어 있는지 확인하세요.
- API 사용량 한도를 초과했을 수 있습니다.

## 📈 테스트 커버리지

- ✅ 주식명 조회 기능
- ✅ 실시간 주식 가격 조회
- ✅ 주식 뉴스 생성
- ✅ Exa MCP 회사 정보 조회 (시뮬레이션)
- ✅ 회사 정보 기반 목표가 계산
- ✅ 투자 근거 생성
- ✅ 통합 리포트 생성

## 🎯 향후 개선 계획

- [ ] 실제 Exa MCP 서버 연동 테스트
- [ ] 성능 테스트 추가
- [ ] 단위 테스트 프레임워크 도입 (pytest)
- [ ] 자동화된 CI/CD 파이프라인 구축
